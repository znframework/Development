<?php
//----------------------------------------------------------------------------------------------------
// ZERONEED PHP WEB FRAMEWORK 
//----------------------------------------------------------------------------------------------------
//
// Yazar      : Ozan UYKUN <ozanbote@windowslive.com> | <ozanbote@gmail.com>
// Site       : www.zntr.net
// Lisans     : The MIT License
// Telif Hakkı: Copyright (c) 2012-2016, zntr.net
//
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
// Sistem Ayarları Başlangıç
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
// Benchmarking Test                                                                  
//----------------------------------------------------------------------------------------------------
//
// Bu ayarın true olarak seçilmesi durumunda sistemin açılış hızını
// ve yüklenme zamanını gösteren bir tablo gösterilir.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['benchmarkingTest']      = false;

//----------------------------------------------------------------------------------------------------
// Application Directory                                                                  
//----------------------------------------------------------------------------------------------------
//
// Uygulamanın çalışcağı dizini belirtilir.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['applicationDirectory']  = 'Application';

//----------------------------------------------------------------------------------------------------
// Application Type                                                                  
//----------------------------------------------------------------------------------------------------
//
// Uygulama türü belirtilir. Kullanılabilir türler: publicaton, development ve local				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['applicationType']       = 'local';

//----------------------------------------------------------------------------------------------------
// Restoration Directory                                                                  
//----------------------------------------------------------------------------------------------------
//
// Uygulamanın restore edileceği dizini belirtilir.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['restorationDirectory']  = 'Restoration';

//----------------------------------------------------------------------------------------------------
// Restoration Mode                                                                  
//----------------------------------------------------------------------------------------------------
//
// Restore işlemi yapılacağı zaman bu değer true olarak ayarlanmalıdır.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['restorationMode']       = false; 

//----------------------------------------------------------------------------------------------------
// Restoration Machines IP                                                                  
//----------------------------------------------------------------------------------------------------
//
// Restore işlemlerinin yapılacağı makinalara ait IP bilgilieri.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['restorationMachinesIP'] = array();

//----------------------------------------------------------------------------------------------------
// Restoration Pages                                                                  
//----------------------------------------------------------------------------------------------------
//
// Çalışmayan, hata oluşmuş kullanıcıların karşılasması istenmeyen sayfalar belirtilir.	     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['restorationPages']      = array(); 

//----------------------------------------------------------------------------------------------------
// Restoration Route Page                                                                  
//----------------------------------------------------------------------------------------------------
//
// Restoration Pages ayarına belirtilmiş sayfalarından herhangi birine istek yapıldığında
// bu ayarın belirtildiği sayfaya yönlendirilir.				     			 	  		  
//
//----------------------------------------------------------------------------------------------------
$system['restorationRoutePage']  = ''; 

//----------------------------------------------------------------------------------------------------
// Sistem Ayarları Bitiş
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//  Ön Yüklenenler
//----------------------------------------------------------------------------------------------------
require_once 'System/Core/Preloading.php';
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//  Uygulama Dizini
//----------------------------------------------------------------------------------------------------
define('APP_DIR', suffix($system['applicationDirectory']));
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//  Restorasyon Dizini
//----------------------------------------------------------------------------------------------------
define('RES_DIR', suffix($system['restorationDirectory']));
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
//  Uygulama Türü
//----------------------------------------------------------------------------------------------------
define('APP_TYPE', $system['applicationType']);
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
// Kullanılabilir Uygulama Seçenekleri
//----------------------------------------------------------------------------------------------------
switch( APP_TYPE )
{ 
	//------------------------------------------------------------------------------------------------
	// Publication Yayın Modu
	// Tüm hatalar kapalıdır.
	// Projenin tamamlanmasından sonra bu modun kullanılması önerilir.
	//------------------------------------------------------------------------------------------------
	case 'publication' :
		error_reporting(0); 
	break;
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	// Local Yerel Mod
	// Standart PHP hata çıktısı kapatılır. Bunun yerine
	// hatalar özel bir çıktı ile gösterilir.
	//------------------------------------------------------------------------------------------------
	case 'local' :
	//------------------------------------------------------------------------------------------------
	// Development Geliştirme Modu
	// Tüm hatalar açıktır.
	//------------------------------------------------------------------------------------------------
	case 'development' : 
		error_reporting(-1);
	break; 
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	// Farklı bir kullanım hatası
	//------------------------------------------------------------------------------------------------
	default: echo 'Invalid Application Environment! Available Options: local, development or publication'; exit;
	//------------------------------------------------------------------------------------------------
}	
//----------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------
// Benchmarking Test
//----------------------------------------------------------------------------------------------------
$benchmarkingTest = $system['benchmarkingTest'];	
//----------------------------------------------------------------------------------------------------

if( $benchmarkingTest === true ) 
{
	//------------------------------------------------------------------------------------------------
	//  Sisteminin Açılış Zamanını Hesaplamayı Başlat
	//------------------------------------------------------------------------------------------------
	$start = microtime();
	//------------------------------------------------------------------------------------------------
}

//----------------------------------------------------------------------------------------------------
//  Sistem Hiyerarşisi -- System/Core/Hierarchy.php
//----------------------------------------------------------------------------------------------------
require_once HIERARCHY_DIR; 
//----------------------------------------------------------------------------------------------------

if( $benchmarkingTest === true )
{	
	//------------------------------------------------------------------------------------------------
	//  Sistemin Açılış Zamanını Hesaplamayı Bitir
	//------------------------------------------------------------------------------------------------
	$finish         = microtime();
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	//  System Elapsed Time Calculating
	//------------------------------------------------------------------------------------------------
	$elapsedTime    = $finish - $start;
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	//  Sistemin Bellek Kullanımını Hesapla
	//------------------------------------------------------------------------------------------------
	$memoryUsage    = memory_get_usage();
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	//  Sistemin Maksimum Bellek Kullanımını Hesapla
	//------------------------------------------------------------------------------------------------
	$maxMemoryUsage = memory_get_peak_usage();
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	//  Benchmark Performans Sonuç Tablosu
	//------------------------------------------------------------------------------------------------
	$benchmarkData  = array
	(
		'elapsedTime'	 => $elapsedTime,
		'memoryUsage'	 => $memoryUsage,
		'maxMemoryUsage' => $maxMemoryUsage
	);	
	
	$benchResult    = Import::template('BenchmarkTable', $benchmarkData, true);
	//------------------------------------------------------------------------------------------------
	
	//------------------------------------------------------------------------------------------------
	//  Benchmark Performans Sonuç Tablosu Yazdırılıyor
	//------------------------------------------------------------------------------------------------
	echo $benchResult;
	//------------------------------------------------------------------------------------------------
			
	//------------------------------------------------------------------------------------------------
	//  Sistem benchmark performans test sonuçlarını raporla.
	//------------------------------------------------------------------------------------------------
	report('Benchmarking Test Result', $benchResult, 'BenchmarkTestResults');
	//------------------------------------------------------------------------------------------------
}